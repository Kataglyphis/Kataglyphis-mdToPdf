% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode$for(hyperrefoptions)$,$hyperrefoptions$$endfor$}{hyperref}
\PassOptionsToPackage{hyphens}{url}
$if(colorlinks)$
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
$endif$
$if(CJKmainfont)$
\PassOptionsToPackage{space}{xeCJK}
$endif$

\documentclass[
	$if(fontsize)$
	$fontsize$,
	$endif$
	$if(papersize)$
	$papersize$paper,
	$endif$
	$if(handout)$
	handout,
	$endif$
	$if(aspectratio)$
	aspectratio=$aspectratio$,
	$endif$
]{beamer}

\makeatletter
\appto\input@path{{./md2pdfLib/presentation/template/latex}}
\makeatother

$if(background-image)$
\usebackgroundtemplate{%
  \includegraphics[width=\paperwidth]{$background-image$}%
}
% In beamer background-image does not work well when other images are used, so this is the workaround
\pgfdeclareimage[width=\paperwidth,height=\paperheight]{background}{$background-image$}
\usebackgroundtemplate{\pgfuseimage{background}}
$endif$

\usepackage{pgfpages}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbols$if(navigation)$$navigation$$else$empty$endif$
$for(beameroption)$
\setbeameroption{$beameroption$}
$endfor$

\widowpenalties 1 10000
\raggedbottom
$if(section-titles)$
\setbeamertemplate{part page}{
  \centering
  \begin{beamercolorbox}[sep=16pt,center]{part title}
    \usebeamerfont{part title}\insertpart\par
  \end{beamercolorbox}
}
\setbeamertemplate{section page}{
  \centering
  \begin{beamercolorbox}[sep=12pt,center]{part title}
    \usebeamerfont{section title}\insertsection\par
  \end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
  \centering
  \begin{beamercolorbox}[sep=8pt,center]{part title}
    \usebeamerfont{subsection title}\insertsubsection\par
  \end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}

$if(beamerarticle)$
\usepackage{beamerarticle} % needs to be loaded first
$endif$
\usepackage{amsmath,amssymb}
$if(linestretch)$
\usepackage{setspace}
$endif$
\usepackage{iftex}


$endif$

\definecolor{dred}{RGB}{105, 240, 174}
\usetheme[english, color, coloraccent=dred, secslide, listings, footnote]{awesome}

\lstdefinelanguage{ts}{
	keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
	ndkeywords={get, number, class, export, boolean, throw, implements, import, this},
	sensitive=false,
	comment=[l]{//},
	morecomment=[s]{/*}{*/},
	morestring=[b]',
	morestring=[b]"
}

\usepackage[
	backend=biber,
	style=alphabetic
]{biblatex}
\usepackage[strict,autostyle]{csquotes}
\nocite{*}
\addbibresource{refs.bib}

\usepackage{fontawesome5}
\def\ergo{\raisebox{.5pt}{\scalebox{.8}{\faCaretRight}}}

\usepackage{contour}
\usepackage{tikzducks}

\usepackage{fontspec}
\setsansfont[
	Ligatures=TeX,
	BoldFont={* Medium},
]{Fira Sans}
\setmonofont[
	Path = ./md2pdfLib/fonts/,
	Scale = .9,
	Extension = .ttf,
	Contextuals=Alternate,
	BoldFont={*-Bold},
	UprightFont={*-Regular},
]{Fira Code}

\usepackage[duration=90,defaulttransition=fade,enduserslide=43]{pdfpc}
\newcommand<>{\talknote}[1]{\only#2{\pdfpcnote{- #1}\relax}}

\def\link #1 to #2;{\def\ULdepth{.5pt}\def\ULthickness{.1pt}\uline{\href{#2}{#1}}}

\usetikzlibrary{tikzmark,shapes.symbols,decorations.pathmorphing}
\def\m#1{\tikzmark{#1}}
\newcommand<>\ul[5][0pt]{\begin{tikzpicture}[o,blend mode=multiply]
	\coordinate(#5_west) at ([yshift=#1-0.25ex]pic cs:#3);
	\coordinate(#5_east) at ([yshift=#1+0.35ex]pic cs:#4);
	\fill[ul=#2,visible on=#6] (#5_west) rectangle node(#5){} (#5_east);
\end{tikzpicture}}
\tikzset{ul/.style={#1!70!black,opacity=0.40,rounded corners=.17ex}}
\newcounter{ulcntr}\setcounter{ulcntr}{0}
\newcommand<>\doul[2]{%
	\m{uls\theulcntr}#2\m{ule\theulcntr}%
	\ul<#3>{#1}{uls\theulcntr}{ule\theulcntr}{}%
	\stepcounter{ulcntr}%
}

\tikzset{bb/.style={draw=tcbcolframe,dash pattern=on 1mm off 1mm,dash phase=0.5mm,tcb@spec,segmentation@style}}
\def\setlinetext#1{\small\color{tcbcolframe}\contourlength{1.5pt}\contour{tcbcolback}{#1}}
\renewenvironment{block}[1][]{%
	\begin{beamerbox}[segmentation code={
		\path[bb] (segmentation.west) to node{\setlinetext{#1}} (segmentation.east);
	}]{gray}{}%
}{\end{beamerbox}}
\newenvironment{sblock}[1][]{
	\begin{beamerbox}[sidebyside,segmentation code={
		\path[bb] (segmentation.north) to node[rotate=90]{\setlinetext{#1}} (segmentation.south);
	}]{gray}{}%
}{\end{beamerbox}}

\usepackage{emoji}

\usepackage[verbatim]{lstfiracode}
\lstdefinestyle{firastyleb}{style=FiraCodeStyle,style=smile@lst@base}
\lstdefinestyle{firastylep}{style=FiraCodeStyle,style=smile@lst@plain}
\lstset{
	tabsize=4,
	style=firastylep,
	%apptoliterate={{=> }{{{=> }}}3} % for whatever reason, the space would otherwise be eaten
}
\lstdefinelanguage{myhaskell}{
	language=haskell,
	morekeywords={MonadReader,Getting,ASetter,Lens},
}
\newcommand\hn[2][]{\lstinline[language=myhaskell,#1]{#2}}
\def\inlineblock#1{\tikz[anchor=base,baseline]\node[inner sep=0.3333em,rnd,fill=lightgray!50,anchor=base,baseline=] {#1};}
\newcommand\h[2][]{\inlineblock{\hn[#1]{#2}}}
\makeatletter
\lstnewenvironment{haskell}{\lstset{language=myhaskell}}{}
\lstnewenvironment{xshaskell}{\lstset{language=myhaskell,basicstyle=\smile@lst@style@base\footnotesize}}{}
\lstnewenvironment{xxshaskell}{\lstset{language=myhaskell,basicstyle=\smile@lst@style@base\tiny}}{}
\def\inpuths #1 from #2 to #3;{\lstinputlisting[language=myhaskell,firstline=#2,lastline=#3]{#1}}
\def\inputhsxs #1 from #2 to #3;{\lstinputlisting[language=myhaskell,firstline=#2,lastline=#3,basicstyle=\smile@lst@style@base\footnotesize]{#1}}
\def\inputhsxxs #1 from #2 to #3;{\lstinputlisting[language=myhaskell,firstline=#2,lastline=#3,basicstyle=\smile@lst@style@base\tiny]{#1}}
\makeatother

\background{data/presentation/images/The World's First AI.jpg}
\title{Build personal web blog with Flutter/Dart}
\subtitle{Cross platform UI development}
\author{Jonas Heinle}
\email{jonasheinle@googlemail.com}
\institute{Institute of Powerbuilding}
\uni{Life University}
\location{Stuttgart}
\date{\today}

\addtobeamertemplate{title page}{}{
\tikz[o]\node[anchor=south east,outer sep=0pt] at (current page.south east)
{\fontsize{4}{4}\selectfont\color{white}This image was generated by AI (DALLE 3)};
}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
  
\usepackage{multicol}

% this is for translating code blocks
$if(highlighting-macros)$
$highlighting-macros$
$endif$

$if(tables)$
\usepackage{longtable,booktabs,array}
$if(multirow)$
\usepackage{multirow}
$endif$
\usepackage{calc} % for calculating minipage widths
\usepackage{caption}
% Make caption package work with longtable
\makeatletter
\def\fnum@table{\tablename~\thetable}
\makeatother
$endif$

\begin{document}

$if(beamer)$
\maketitle
$else$
\frame{\titlepage}
$endif$

$body$

% \mainmatter
% \makeatletter
% \newcommand*{\rom}[1]{\expandafter\@slowromancap\romannumeral #1@}
% \makeatother
% \newcommand<>\goal[4][]{\begin{visibleenv}#5\begin{tikzpicture}[node distance=.75ex]
% 	\node[text width=0.43\textwidth,align=left] (H) {\color{accent}\bfseries#3};
% 	\node[text width=0.43\textwidth,align=left,below=of H.south west,anchor=north west] (D) {#4};
% 	\node[roundednode,fit=(H)(D),node on layer=background,shadow,draw=none,fill=gray!20] (F) {};
% 	\node[anchor=north east,on layer=background,opacity=0.15] at (F.north east) {\Huge\color{accent}\bfseries\MakeUppercase{\rom{#2}}};
% 	\if\isempty{#1}\else\begin{scope}[transparency group,opacity=0.7]
% 		\draw[draw=red,lcr,line width=1ex,visible on=<#1>] (F.north west) -- (F.south east);
% 		\draw[draw=red,lcr,line width=1ex,visible on=<#1>] (F.south west) -- (F.north east);
% 	\end{scope}\fi
% \end{tikzpicture}\par\bigskip\end{visibleenv}}
% \begin{frame}[wide]
% 	\frametitle{Learning Objectives}
% 	\begin{wide}
% 	\begin{multicols}{2}
% 		\goal<2->{1}{Why do we need lenses?}{Understand where the idea of lenses come from, and how
% 			one could have come up with them.}
% 		\goal<3->{2}{How can I use them?}{Know the basic functions and operators and know how to
% 			discover new ones.}
% 		\goal<4->{3}{What else is there?}{Know of other lens-like abstractions, why we
% 			presumably need them, and how they differ.}
% 		\goal<5->[6-]{4}{WTF are those types?}{Understand the ins and outs of the lens package and
% 			every type.}
% 	\end{multicols}
% 	\end{wide}
% \end{frame}

% \section{What}

% \colorlet{m}{blue!45!black}
% \tikzset{q/.style={chamfered rectangle,draw,lw,chamfered rectangle xsep=2cm,fill=m,text=white}}
% \tikzset{qa/.style={q,text width=0.4\textwidth}}
% \def\qn#1{\textcolor{orange!80!black}{\textbf{#1}}}
% \begingroup
% \colorlet{accent}{m}
% \makeatletter\smile@listings@initcolors\makeatother
% \setbeamercolor{footline}{fg=white,bg=m}
% \setbeamercolor{footlineright}{fg=white,bg=m}
% \begin{frame}[t,fragile]
% 	\frametitle{What are lenses}
% 	\begin{wide}\vspace{5mm}
% 		\begin{haskell}
% 			type Lens s t a b = forall f. Functor f => (a -> f b) -> s -> f t
% 		\end{haskell}
% 		\begin{visibleenv}<2->
% 		\begin{tikzpicture}[o,node distance=.5ex]
% 			\draw[draw=none,top color=white,bottom color=m] (current page.west) rectangle ([yshift=1.8ex]current page.south east);

% 			\node[q] at ([yshift=-5mm]current page) (Q) {What is the purpose of a lens, according to the types above?};
% 			\coordinate (AS) at ([yshift=-1.3cm]Q.south);

% 			\node[qa,left=of AS,left,muted on=<3-|handout:2->] (A) {\scriptsize\qn{A:} A package for creating visualizations};
% 			\node[qa,right=of AS,right] (B) {\scriptsize\qn{B:} A tool for handling nested ADTs};

% 			\node[qa,below=of A,muted on=<3-|handout:2->] (C) {\scriptsize\qn{C:} A framework for building UIs};
% 			\node[qa,below=of B,muted on=<3-|handout:2->] (D) {\scriptsize\qn{D:} A package for simulating optical lenses};

% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (A.east) to (B.west);
% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (C.east) to (D.west);

% 			\draw[lw,short=-1pt] (Q.west) to (Q.west -| current page.west);
% 			\draw[lw,short=-1pt] (Q.east) to (Q.east -| current page.east);

% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (A.west) to (A.west -| current page.west);
% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (C.west) to (C.west -| current page.west);
% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (B.east) to (B.east -| current page.east);
% 			\draw[lw,short=-1pt,muted on=<3-|handout:2->] (D.east) to (D.east -| current page.east);
% 		\end{tikzpicture}
% 		\end{visibleenv}
% 	\end{wide}
% 	\begin{modal}<4|handout:3>
% 		\begin{quote}
% 			In Haskell, types provide a pretty good explanation of what a function does. Good luck deciphering lens types.
% 		\end{quote}\par
% 		\hfill Roman Cheplyaka
% 	\end{modal}
% \end{frame}
% \endgroup

$for(include-before)$
$include-before$

$endfor$

$if(has-frontmatter)$
\backmatter
$endif$
$if(natbib)$
$if(bibliography)$
$if(biblio-title)$
$if(has-chapters)$
\renewcommand\bibname{$biblio-title$}
$else$
\renewcommand\refname{$biblio-title$}
$endif$
$endif$
$if(beamer)$
\begin{frame}[allowframebreaks]{$biblio-title$}
  \bibliographytrue
$endif$
  \bibliography{$for(bibliography)$$bibliography$$sep$,$endfor$}
$if(beamer)$
\end{frame}
$endif$

$endif$
$endif$
$if(biblatex)$
$if(beamer)$
\begin{frame}[allowframebreaks]{$biblio-title$}
  \bibliographytrue
  \printbibliography[heading=none]
\end{frame}
$else$
\printbibliography$if(biblio-title)$[title=$biblio-title$]$endif$
$endif$

$endif$

% \begin{frame}
% 	\frametitle{What are lenses}
% 	\uncover<2->{Well, \enquote{lens} is also a \link package to https://hackage.haskell.org/package/lens;}
% 	\uncover<3->{\ldots{} Here are some random functions and operators from that package:\bigskip}
% 	\begin{visibleenv}<4->
% 	\begin{center}
% 		\begin{tabular}{lcl}
% 		\hline
% 		\hn{view} & \hn{_1}  & \hn{allOf}    \\ \hline
% 		\hn{set}  & \hn{^.}  & \hn{anyOf}    \\ \hline
% 		\hn{over} & \hn{^?!} & \hn{concatOf} \\ \hline
% 		\end{tabular}
% 	\end{center}\bigskip
% 	\end{visibleenv}
% 	\uncover<5->{We'll shortly see what they do and how we can use them.}
% \end{frame}

% \section{Why}

% \begin{frame}[fragile]
% 	\frametitle{Why do we need them}
% 	\onslide<2->%
% 	Imagine you want to parse configuration files in Haskell. To model them, you come up
% 	with the following ADTs:\par\medskip
% 	\onslide<3->%
% 	\begin{haskell}
% data File = File {
%   name    :: String,
%   entries :: [Entry]
% }
% §\onslide<4->§data Entry = Entry {
%   key   :: String,
%   value :: Value
% }
% §\onslide<5->§data Value = Value {
%   curr :: String,
%   def  :: String
% }
% 	\end{haskell}
% \end{frame}

% \begin{frame}
% 	\frametitle{Why do we need them}
% 	\onslide<2->%
% 	Let's say we parsed a file into the following configuration:\bigskip
% 	\onslide<3->%
% 	\inpuths latex_template/examples/example.hs from 24 to 28;\bigskip
% 	\onslide<4->%
% 	Cool, isn't it. Now we want to work with this representation.
% \end{frame}

% \begin{frame}[fragile]
% 	\frametitle{Why do we need them}
% 	\begin{haskell}
% 		§\onslide<2->§getEntry :: String -> File -> Entry
% 		§\onslide<6->§getEntry k = §\onslide<5->§head . §\onslide<4->§filter ((==) k . key) . §\onslide<3->§entries

% 		§\onslide<7->§getCurrentValue :: Entry -> String
% 		§\onslide<10->§getCurrentValue = §\onslide<9->§curr . §\onslide<8->§value

% 		§\onslide<11->§setCurrentValue :: String -> Entry -> Entry
% 		§\onslide<12->§setCurrentValue newValue entry = entry {
% 			value = (value entry) {
% 				curr = newValue
% 			}
% 		}
% 	\end{haskell}\medskip
% 	\onslide<13->Oof, this sucks. And it get's even worse the deeper the ADT gets!
% 	\onslide<1->\begin{tikzpicture}[o]
% 		\node[anchor=west,xshift=2mm,rnd,fill=gray!20,shadow] at (current page.west) (A) {
% 			\inputhsxxs latex_template/examples/example.hs from 1 to 12;
% 		};
% 	\end{tikzpicture}
% \end{frame}

% \begin{frame}[fragile]
% 	\frametitle{Let's reinvent the lens}
% 	\onslide<2->Now, we can build our lens abstraction:
% 	\begin{xshaskell}
% 		§\onslide<3->§data Lens s a = Lens {
% 			§\onslide<4->§get :: s -> a,
% 			§\onslide<5->§modify :: (a -> a) -> s -> s
% 		§\onslide<3->§}
% 	\end{xshaskell}\medskip

% 	\onslide<6->We need to reimplement the function composition:
% 	\begin{xshaskell}
% 		§\onslide<7->§compose :: Lens a b -> Lens b c -> Lens a c
% 		§\onslide<8->§compose (Lens g m) (Lens g' m') = Lens {
% 			§\onslide<9->§get = g' . g,
% 			§\onslide<10->§modify = m . m'
% 		§\onslide<8->§}
% 	\end{xshaskell}\medskip

% 	\onslide<11->For easier handling, we also define \h{set} as a little helper:
% 	\begin{xshaskell}
% 		§\onslide<12->§set :: Lens s a -> a -> s -> s
% 		§\onslide<13->§set (Lens _ modify) = modify§\onslide<14->§ . const
% 	\end{xshaskell}
% \end{frame}

% \section{References}
% \defbibheading{bibliography}[\bibname]{}

% \begin{frame}[allowframebreaks]
% 	\frametitle{Reading suggestions}
% 	\printbibliography[keyword={suggestion}]
% \end{frame}

% \begin{frame}[allowframebreaks]
% 	\frametitle{References}
% 	\printbibliography
% \end{frame}
\end{document}
